<script>
  let audioCtx;
  let soundEnabled = false;

  function enableSound() {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    playMelody();
    soundEnabled = true;
    alert("ì¢…ì†Œë¦¬ í™œì„±í™” ì™„ë£Œ");
  }

  // ðŸŽµ ë ˆìž¥ì¡° ë„ë¯¸ì†” ë©œë¡œë””
  const melody = [
    293.66, 369.99, 440.00, 369.99,
    440.00, 369.99, 293.66, 277.18,
    246.94, 220.00, 196.00, 174.61,
    293.66, 293.66,
    277.18, 293.66, 329.63
  ];

  function playMelody() {
    if (!audioCtx) return;

    let time = audioCtx.currentTime;

    melody.forEach(freq => {
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();

      osc.frequency.value = freq;
      osc.type = "sine";

      gain.gain.setValueAtTime(0.2, time);
      gain.gain.exponentialRampToValueAtTime(0.001, time + 0.4);

      osc.connect(gain);
      gain.connect(audioCtx.destination);

      osc.start(time);
      osc.stop(time + 0.4);

      time += 0.45;
    });
  }

  const timetable = [
    { name: "1êµì‹œ", start: "08:40", end: "10:00" },
    { name: "ì‰¬ëŠ”ì‹œê°„", start: "10:00", end: "10:20" },
    { name: "2êµì‹œ", start: "10:20", end: "11:40" },
    { name: "ì ì‹¬", start: "11:40", end: "12:40" },
    { name: "3êµì‹œ", start: "12:40", end: "14:00" },
    { name: "ì‰¬ëŠ”ì‹œê°„", start: "14:00", end: "14:20" },
    { name: "4êµì‹œ", start: "14:20", end: "15:30" }
  ];

  function tick() {
    const now = new Date();
    const h = String(now.getHours()).padStart(2, "0");
    const m = String(now.getMinutes()).padStart(2, "0");
    const s = String(now.getSeconds()).padStart(2, "0");
    const nowStr = `${h}:${m}`;

    document.getElementById("time").innerText = `${h}:${m}:${s}`;

    const box = document.getElementById("schedule");
    box.innerHTML = "";
    timetable.forEach(t => {
      const div = document.createElement("div");
      div.className = "item";
      if (nowStr >= t.start && nowStr < t.end) div.classList.add("active");
      div.textContent = `${t.name} ${t.start}â€“${t.end}`;
      box.appendChild(div);
    });

    // â° êµì‹œ ì‹œìž‘ ì‹œ ë©œë¡œë”” ì¢…
    if (soundEnabled && s === "00") {
      timetable.forEach(t => {
        if (t.start === nowStr) playMelody();
      });
    }
  }

  setInterval(tick, 1000);
</script>
